This is modified version of back_propagation in ver_2 with mini-batch processing.
